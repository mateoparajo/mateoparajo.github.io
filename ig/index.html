<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta http-equiv="X-UA-Compatible" content="ie=edge" />
  
  <!-- SEO & Meta Tags -->
  <title>Instagram â€“ mparajo448</title>
  <meta name="description" content="Perfil de Instagram de mparajo448" />
  <meta name="theme-color" content="#E4405F" />
  <meta name="robots" content="noindex, nofollow" />
  
  <!-- Open Graph -->
  <meta property="og:title" content="Instagram â€“ mparajo448" />
  <meta property="og:description" content="SÃ­gueme en Instagram" />
  <meta property="og:type" content="website" />
  
  <!-- Security Headers -->
  <meta http-equiv="Referrer-Policy" content="strict-origin-when-cross-origin" />
  <meta http-equiv="Content-Security-Policy" content="default-src 'self' https:; script-src 'self' https://www.googletagmanager.com; img-src 'self' https:; connect-src 'self' https://*.google-analytics.com https://*.analytics.google.com" />

  <!-- Preconnect -->
  <link rel="preconnect" href="https://www.googletagmanager.com" />
  <link rel="preconnect" href="https://www.google-analytics.com" />
  <link rel="dns-prefetch" href="https://www.instagram.com" />

  <!-- Google Analytics 4 -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-5EP61PTFRX"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-5EP61PTFRX', { 
      anonymize_ip: true,
      allow_google_signals: false,
      allow_ad_personalization_signals: false
    });
  </script>

  <style>
    :root {
      --primary-color: #E4405F;
      --secondary-color: #405DE6;
      --text-primary: #262626;
      --text-secondary: #65676b;
      --bg-light: #F7F7F7;
      --border-color: #DBDBDB;
      --success-color: #31A24C;
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    html, body {
      width: 100%;
      height: 100%;
      scroll-behavior: smooth;
    }

    body {
      display: flex;
      justify-content: center;
      align-items: center;
      min-height: 100vh;
      background: linear-gradient(135deg, var(--secondary-color) 0%, var(--primary-color) 100%);
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
      color: var(--text-primary);
      font-size: 16px;
      padding: 20px;
    }

    .container {
      background: white;
      border-radius: 16px;
      box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
      padding: 48px 32px;
      max-width: 360px;
      width: 100%;
      text-align: center;
      animation: slideIn 0.5s ease-out;
    }

    @keyframes slideIn {
      from {
        opacity: 0;
        transform: translateY(20px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .icon {
      width: 64px;
      height: 64px;
      margin: 0 auto 20px;
      background: linear-gradient(135deg, var(--secondary-color) 0%, var(--primary-color) 100%);
      border-radius: 16px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 32px;
      animation: pulse 2s ease-in-out infinite;
    }

    @keyframes pulse {
      0%, 100% { transform: scale(1); }
      50% { transform: scale(1.05); }
    }

    .loader {
      width: 48px;
      height: 48px;
      border: 4px solid var(--bg-light);
      border-top: 4px solid var(--primary-color);
      border-right: 4px solid var(--secondary-color);
      border-radius: 50%;
      animation: spin 0.8s linear infinite;
      margin: 0 auto 20px;
    }

    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }

    h1 {
      font-size: 28px;
      font-weight: 600;
      margin-bottom: 8px;
    }

    .subtitle {
      font-size: 14px;
      color: var(--text-secondary);
      margin-bottom: 24px;
    }

    .info-box {
      background: var(--bg-light);
      border: 1px solid var(--border-color);
      border-radius: 12px;
      padding: 16px;
      margin-bottom: 20px;
      font-size: 13px;
      color: var(--text-secondary);
    }

    .info-box strong {
      color: var(--text-primary);
      display: block;
      margin-bottom: 4px;
    }

    .status {
      display: inline-flex;
      align-items: center;
      gap: 8px;
      font-size: 13px;
      color: var(--success-color);
      margin-top: 16px;
    }

    .status::before {
      content: '';
      width: 8px;
      height: 8px;
      background: var(--success-color);
      border-radius: 50%;
      animation: blink 1s ease-in-out infinite;
    }

    @keyframes blink {
      0%, 49%, 100% { opacity: 1; }
      50%, 99% { opacity: 0.3; }
    }

    @media (max-width: 480px) {
      body { padding: 16px; }
      .container { padding: 36px 24px; }
      h1 { font-size: 24px; }
      .icon { width: 56px; height: 56px; font-size: 28px; }
      .loader { width: 40px; height: 40px; }
    }

    @media (prefers-color-scheme: dark) {
      body { background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%); }
      .container { background: #262626; }
      h1 { color: white; }
      .subtitle, .info-box { color: #b0b0b0; }
      .info-box { background: #333; border-color: #404040; }
      .info-box strong { color: #e0e0e0; }
    }

    @media (prefers-reduced-motion: reduce) {
      * {
        animation-duration: 0.01ms !important;
        animation-iteration-count: 1 !important;
        transition-duration: 0.01ms !important;
      }
    }

    noscript .container {
      animation: none;
    }

    noscript a {
      display: inline-block;
      background: linear-gradient(135deg, var(--secondary-color) 0%, var(--primary-color) 100%);
      color: white;
      padding: 12px 32px;
      border-radius: 8px;
      text-decoration: none;
      font-weight: 600;
      margin-top: 16px;
    }

    noscript a:active {
      transform: scale(0.98);
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="icon">ðŸ“±</div>
    <div class="loader"></div>
    <h1>Redirigiendo...</h1>
    <p class="subtitle">Te llevaremos a Instagram en un momento</p>
    <div class="info-box">
      <strong>ðŸ‘¤ mparajo448</strong>
      SÃ­gueme en Instagram
    </div>
    <div class="status">Conectando</div>
  </div>

  <noscript>
    <div class="container">
      <h1>ðŸ“± Instagram</h1>
      <p class="subtitle">Si no eres redirigido automÃ¡ticamente,</p>
      <a href="https://www.instagram.com/mparajo448/">abre Instagram aquÃ­</a>
    </div>
  </noscript>

  <script>
    const CONFIG = {
      instagram: {
        username: "mparajo448",
        webUrl: "https://www.instagram.com/mparajo448/",
        appSchemes: {
          ios: "instagram://user/",
          android: "intent://instagram.com/_u/mparajo448/#Intent;scheme=https;package=com.instagram.android;end"
        }
      },
      timing: {
        appDetectionDelay: 2000,
        redirectDelay: 300,
        fallbackDelay: 2500
      }
    };

    class InstagramRedirector {
      constructor() {
        this.browser = this.detectBrowser();
        this.redirected = false;
      }

      detectBrowser() {
        const ua = navigator.userAgent;
        return {
          isIOS: /iPad|iPhone|iPod/.test(ua),
          isAndroid: /Android/.test(ua),
          isChrome: /Chrome|CriOS/.test(ua),
          isSafari: /Safari/.test(ua) && !/Chrome|CriOS/.test(ua),
          isFirefox: /Firefox|FxiOS/.test(ua),
          isEdge: /Edg/.test(ua),
          isInstagramApp: /Instagram/.test(ua),
          userAgent: ua
        };
      }

      getQueryParam(name) {
        try {
          const value = new URLSearchParams(window.location.search).get(name);
          if (!value) return null;
          const trimmed = value.trim();
          return /^[a-zA-Z0-9_-]{1,50}$/.test(trimmed) ? trimmed : null;
        } catch {
          return null;
        }
      }

      trackEvent(source, destination) {
        if (typeof gtag === 'undefined') return Promise.resolve();
        
        return new Promise(resolve => {
          try {
            gtag("event", "qr_open", {
              src: source,
              username: CONFIG.instagram.username,
              destination: destination,
              device: this.browser.isIOS ? 'iOS' : this.browser.isAndroid ? 'Android' : 'Web',
              browser: this.getBrowserName(),
              timestamp: new Date().toISOString()
            });
            setTimeout(resolve, 300);
          } catch {
            resolve();
          }
        });
      }

      getBrowserName() {
        const { isChrome, isSafari, isFirefox, isEdge } = this.browser;
        if (isChrome) return 'Chrome';
        if (isSafari) return 'Safari';
        if (isFirefox) return 'Firefox';
        if (isEdge) return 'Edge';
        return 'Unknown';
      }

      async redirect(url) {
        if (this.redirected) return;
        this.redirected = true;
        await this.trackEvent(this.getQueryParam("src") || "direct", "web");
        window.location.replace(url);
      }

      async attemptAppOpen() {
        const { isIOS, isAndroid, isInstagramApp } = this.browser;

        if (isInstagramApp) {
          console.log('Ya estamos en Instagram app');
          return false;
        }

        return new Promise((resolve) => {
          if (isIOS) {
            this.attemptIOSApp().then(resolve);
          } else if (isAndroid) {
            this.attemptAndroidApp().then(resolve);
          } else {
            resolve(false);
          }
        });
      }

      async attemptIOSApp() {
        return new Promise((resolve) => {
          const source = this.getQueryParam("src") || "direct";
          const appUrl = `instagram://user/`;
          const startTime = Date.now();
          let resolved = false;

          // MÃ©todo 1: Intentar con iframe
          const iframe = document.createElement('iframe');
          iframe.style.display = 'none';
          
          const cleanup = () => {
            try { document.body.removeChild(iframe); } catch {}
            window.removeEventListener('visibilitychange', visibilityHandler);
            if (!resolved) {
              resolved = true;
              resolve(false);
            }
          };

          const visibilityHandler = () => {
            if (document.hidden) {
              if (!resolved) {
                resolved = true;
                this.trackEvent(source, "app");
              }
              cleanup();
            }
          };

          window.addEventListener('visibilitychange', visibilityHandler);
          
          try {
            iframe.src = appUrl;
            document.body.appendChild(iframe);
          } catch {}

          // Fallback despuÃ©s de cierto tiempo
          setTimeout(() => {
            cleanup();
          }, CONFIG.timing.appDetectionDelay);
        });
      }

      async attemptAndroidApp() {
        return new Promise((resolve) => {
          const source = this.getQueryParam("src") || "direct";
          const startTime = Date.now();
          let resolved = false;

          const cleanup = () => {
            window.removeEventListener('visibilitychange', visibilityHandler);
            if (!resolved) {
              resolved = true;
              resolve(false);
            }
          };

          const visibilityHandler = () => {
            if (document.hidden) {
              if (!resolved) {
                resolved = true;
                this.trackEvent(source, "app");
              }
              cleanup();
            }
          };

          window.addEventListener('visibilitychange', visibilityHandler);

          // Android: usar intent o schema directo
          try {
            window.location.href = `intent://instagram.com/_u/mparajo448/#Intent;scheme=https;package=com.instagram.android;end`;
          } catch {
            try {
              window.location.href = `instagram://user/`;
            } catch {}
          }

          // Fallback despuÃ©s de cierto tiempo
          setTimeout(() => {
            cleanup();
          }, CONFIG.timing.appDetectionDelay);
        });
      }

      async init() {
        await new Promise(resolve => setTimeout(resolve, CONFIG.timing.redirectDelay));

        // Intentar abrir app
        const appOpened = await this.attemptAppOpen();

        if (!appOpened) {
          // Fallback a web
          setTimeout(() => {
            this.redirect(CONFIG.instagram.webUrl);
          }, CONFIG.timing.fallbackDelay);
        }
      }
    }

    // Iniciar cuando DOM estÃ© listo
    if (document.readyState === 'loading') {
      document.addEventListener('DOMContentLoaded', () => {
        new InstagramRedirector().init();
      });
    } else {
      new InstagramRedirector().init();
    }

    // Failsafe final: redirigir despuÃ©s de 8 segundos si nada pasÃ³
    setTimeout(() => {
      if (window.location.href.includes('ig/')) {
        window.location.replace(CONFIG.instagram.webUrl);
      }
    }, 8000);
  </script>
</body>
</html>